import { useCallback } from "react";
import { Panel } from "~/components/Panel";

export function App() {
  const helpId = "help";
  const historyId = "history";

  const onShare = useCallback(() => {
    navigator.clipboard.writeText(window.location.href);
  }, []);

  return (
    <div className="grid grid-rows-[auto_1fr_auto] mx-auto min-h-dvh">
      <header className="grid grid-cols-[auto_1fr] items-center gap-12 h-12 px-6">
        <h1>
          <a href="/">
            <svg
              viewBox="0 0 216 40"
              fill="currentColor"
              xmlns="http://www.w3.org/2000/svg"
              className="h-7 block"
              aria-label="localthreat"
            >
              <path d="M40.8492 0H2.15085C0.965341 0 0 0.897494 0 1.99968V29.9873C0 31.0895 0.965341 31.987 2.15085 31.987H7.73966C8.21386 31.987 8.60339 32.3413 8.60339 32.79V39.1985C8.60339 39.907 9.52639 40.2692 10.0683 39.7653L17.1983 32.2626C17.3592 32.0894 17.5963 31.9949 17.8419 31.9949H40.8492C42.0347 31.9949 43 31.0974 43 29.9952V1.99968C43 0.897494 42.0347 0 40.8492 0ZM23.6508 27.1846C23.6508 27.6255 23.2698 27.9877 22.7871 27.9877H20.2044C19.7302 27.9877 19.3407 27.6334 19.3407 27.1846V24.7834C19.3407 24.3426 19.7217 23.9804 20.2044 23.9804H22.7871C23.2613 23.9804 23.6508 24.3347 23.6508 24.7834V27.1846ZM23.6508 19.1938C23.6508 19.6347 23.2698 19.9968 22.7871 19.9968H20.2044C19.7302 19.9968 19.3407 19.6425 19.3407 19.1938V4.79451C19.3407 4.35364 19.7217 3.99149 20.2044 3.99149H22.7871C23.2613 3.99149 23.6508 4.34576 23.6508 4.79451V19.1938Z" />
              <path d="M61.2021 30.6162C60.8475 30.6162 60.5422 30.4981 60.2862 30.2619C60.0498 30.006 59.9317 29.7009 59.9317 29.3466V11.4249H57.2431C57.0658 11.4249 56.9181 11.3659 56.7999 11.2478C56.6818 11.1297 56.6227 10.982 56.6227 10.8049V8.62002C56.6227 8.44288 56.6818 8.29525 56.7999 8.17715C56.9181 8.05905 57.0658 8 57.2431 8H62.2066C62.5611 8 62.8566 8.12794 63.0929 8.38383C63.349 8.62003 63.477 8.91528 63.477 9.26958V27.1913H66.1655C66.3428 27.1913 66.4905 27.2503 66.6087 27.3684C66.7269 27.4865 66.786 27.6341 66.786 27.8113V29.9961C66.786 30.1733 66.7269 30.3209 66.6087 30.439C66.4905 30.5571 66.3428 30.6162 66.1655 30.6162H61.2021Z" />
              <path d="M75.2618 31C73.9815 31 72.7997 30.6949 71.7164 30.0847C70.6528 29.4549 69.8059 28.6085 69.1756 27.5456C68.5453 26.4827 68.2302 25.3312 68.2302 24.0911V20.2234C68.2302 18.9833 68.5453 17.8318 69.1756 16.7689C69.8059 15.706 70.6528 14.8695 71.7164 14.2593C72.7997 13.6294 73.9815 13.3145 75.2618 13.3145C76.542 13.3145 77.714 13.6294 78.7776 14.2593C79.8609 14.8695 80.7176 15.706 81.3479 16.7689C81.9782 17.8318 82.2933 18.9833 82.2933 20.2234V24.0911C82.2933 25.3312 81.9782 26.4827 81.3479 27.5456C80.7176 28.6085 79.8609 29.4549 78.7776 30.0847C77.714 30.6949 76.542 31 75.2618 31ZM75.2618 27.5751C76.2269 27.5751 77.0443 27.2405 77.714 26.5712C78.4033 25.8823 78.748 25.0556 78.748 24.0911V20.2234C78.748 19.2589 78.4033 18.442 77.714 17.7728C77.0443 17.0839 76.2269 16.7394 75.2618 16.7394C74.2966 16.7394 73.4694 17.0839 72.78 17.7728C72.1104 18.442 71.7755 19.2589 71.7755 20.2234V24.0911C71.7755 25.0556 72.1104 25.8823 72.78 26.5712C73.4694 27.2405 74.2966 27.5751 75.2618 27.5751Z" />
              <path d="M92.004 31C90.7237 31 89.542 30.6851 88.4587 30.0552C87.3951 29.4253 86.5481 28.5691 85.9178 27.4865C85.2876 26.4039 84.9724 25.2229 84.9724 23.9435V20.371C84.9724 19.0916 85.2876 17.9106 85.9178 16.828C86.5481 15.7454 87.3951 14.8892 88.4587 14.2593C89.542 13.6294 90.7237 13.3145 92.004 13.3145C92.9888 13.3145 93.9342 13.5212 94.8403 13.9345C95.7463 14.3282 96.5243 14.8892 97.1743 15.6175C97.3122 15.7552 97.3811 15.9127 97.3811 16.0899C97.3811 16.3064 97.2925 16.5032 97.1152 16.6804L95.8448 17.9499C95.7069 18.0877 95.5493 18.1566 95.3721 18.1566C95.1948 18.1566 95.0274 18.068 94.8698 17.8909C94.1017 17.1232 93.1464 16.7394 92.004 16.7394C91.0389 16.7394 90.2116 17.0839 89.5223 17.7728C88.8526 18.442 88.5178 19.2589 88.5178 20.2234V24.0911C88.5178 25.0556 88.8526 25.8823 89.5223 26.5712C90.2116 27.2405 91.0389 27.5751 92.004 27.5751C93.1464 27.5751 94.1017 27.1913 94.8698 26.4236C95.0274 26.2465 95.1948 26.1579 95.3721 26.1579C95.5493 26.1579 95.7069 26.2268 95.8448 26.3646L97.1152 27.6341C97.2925 27.8113 97.3811 28.0081 97.3811 28.2246C97.3811 28.4018 97.3122 28.5593 97.1743 28.697C96.5243 29.4253 95.7463 29.9961 94.8403 30.4095C93.9342 30.8032 92.9888 31 92.004 31Z" />
              <path d="M104.604 31C102.949 31 101.6 30.5374 100.556 29.6123C99.5318 28.6675 99.0197 27.4472 99.0197 25.9512C99.0197 24.5931 99.4924 23.4711 100.438 22.5854C101.383 21.6799 102.713 21.0894 104.426 20.8139C104.86 20.7745 105.273 20.7154 105.667 20.6367C107.046 20.4792 107.883 20.3611 108.178 20.2824C108.907 20.1643 109.272 19.751 109.272 19.0424C109.272 18.3141 108.966 17.7334 108.356 17.3004C107.765 16.8477 107.016 16.6213 106.11 16.6213C104.515 16.6213 103.353 17.202 102.624 18.3633C102.467 18.6192 102.279 18.7471 102.063 18.7471C101.905 18.7471 101.777 18.7077 101.679 18.629L100.024 17.5071C99.8469 17.389 99.7583 17.2217 99.7583 17.0051C99.7583 16.9461 99.778 16.8575 99.8174 16.7394C100.389 15.6568 101.235 14.8203 102.358 14.2298C103.481 13.6196 104.751 13.3145 106.169 13.3145C107.469 13.3145 108.612 13.5605 109.597 14.0526C110.581 14.5447 111.34 15.2435 111.871 16.1489C112.423 17.0543 112.699 18.0976 112.699 19.2786V29.9961C112.699 30.1733 112.64 30.3209 112.521 30.439C112.403 30.5571 112.256 30.6162 112.078 30.6162H110.069C109.892 30.6162 109.744 30.567 109.626 30.4686C109.508 30.3505 109.449 30.193 109.449 29.9961V28.8447C108.09 30.2816 106.475 31 104.604 31ZM104.869 27.8408C105.638 27.8408 106.366 27.644 107.056 27.2503C107.745 26.8567 108.297 26.3449 108.71 25.715C109.144 25.0655 109.36 24.3864 109.36 23.6778V23.0873L107.144 23.4121C105.943 23.5499 105.165 23.6581 104.81 23.7368C103.195 24.0321 102.388 24.7309 102.388 25.8331C102.388 26.4433 102.614 26.9354 103.067 27.3094C103.52 27.6637 104.121 27.8408 104.869 27.8408Z" />
              <path d="M118.506 30.6162C118.151 30.6162 117.846 30.4981 117.59 30.2619C117.353 30.006 117.235 29.7009 117.235 29.3466V11.4249H114.547C114.369 11.4249 114.222 11.3659 114.103 11.2478C113.985 11.1297 113.926 10.982 113.926 10.8049V8.62002C113.926 8.44288 113.985 8.29525 114.103 8.17715C114.222 8.05905 114.369 8 114.547 8H119.51C119.865 8 120.16 8.12794 120.396 8.38383C120.653 8.62003 120.781 8.91528 120.781 9.26958V27.1913H123.469C123.646 27.1913 123.794 27.2503 123.912 27.3684C124.03 27.4865 124.09 27.6341 124.09 27.8113V29.9961C124.09 30.1733 124.03 30.3209 123.912 30.439C123.794 30.5571 123.646 30.6162 123.469 30.6162H118.506Z" />
              <path d="M132.425 30.6162C130.888 30.6162 129.637 30.1438 128.672 29.199C127.727 28.2542 127.254 27.0141 127.254 25.4788V17.0051H125.216C125.038 17.0051 124.891 16.9461 124.772 16.828C124.654 16.7099 124.595 16.5623 124.595 16.3851V14.3184C124.595 14.1412 124.654 13.9936 124.772 13.8755C124.891 13.7574 125.038 13.6983 125.216 13.6983H127.254V10.5096C127.254 10.3325 127.313 10.1849 127.431 10.0668C127.55 9.94865 127.697 9.8896 127.875 9.8896H130.179C130.356 9.8896 130.504 9.94865 130.622 10.0668C130.74 10.1849 130.8 10.3325 130.8 10.5096V13.6983H135.793C135.97 13.6983 136.118 13.7574 136.236 13.8755C136.354 13.9936 136.413 14.1412 136.413 14.3184V16.4146C136.413 16.5918 136.354 16.7394 136.236 16.8575C136.118 16.9756 135.97 17.0347 135.793 17.0347H130.8V25.3312C130.8 25.9217 130.967 26.3941 131.302 26.7484C131.656 27.1027 132.119 27.2798 132.69 27.2798L135.793 27.3094C135.97 27.3094 136.118 27.3684 136.236 27.4865C136.354 27.6046 136.413 27.7522 136.413 27.9294V29.9961C136.413 30.1733 136.354 30.3209 136.236 30.439C136.118 30.5571 135.97 30.6162 135.793 30.6162H132.425Z" />
              <path d="M139.939 30.6162C139.762 30.6162 139.614 30.5571 139.496 30.439C139.378 30.3209 139.319 30.1733 139.319 29.9961V8.62002C139.319 8.44288 139.378 8.29525 139.496 8.17715C139.614 8.05905 139.762 8 139.939 8H142.244C142.421 8 142.569 8.05905 142.687 8.17715C142.805 8.29525 142.864 8.44288 142.864 8.62002V15.1451C143.435 14.5742 144.085 14.1314 144.814 13.8164C145.543 13.4818 146.291 13.3145 147.059 13.3145C148.281 13.3145 149.354 13.5802 150.28 14.1117C151.225 14.6234 151.954 15.3517 152.466 16.2965C152.978 17.2217 153.234 18.2944 153.234 19.5148V29.9961C153.234 30.1733 153.175 30.3209 153.057 30.439C152.939 30.5571 152.791 30.6162 152.614 30.6162H150.309C150.132 30.6162 149.984 30.5571 149.866 30.439C149.748 30.3209 149.689 30.1733 149.689 29.9961V19.9576C149.689 18.9144 149.423 18.1172 148.891 17.5661C148.359 16.9953 147.611 16.7099 146.646 16.7099C145.484 16.7099 144.558 17.0937 143.869 17.8614C143.199 18.6093 142.864 19.6427 142.864 20.9615V29.9961C142.864 30.1733 142.805 30.3209 142.687 30.439C142.569 30.5571 142.421 30.6162 142.244 30.6162H139.939Z" />
              <path d="M156.578 30.6162C156.401 30.6162 156.253 30.5571 156.135 30.439C156.017 30.3209 155.958 30.1733 155.958 29.9961V27.8113C155.958 27.6341 156.017 27.4865 156.135 27.3684C156.253 27.2503 156.401 27.1913 156.578 27.1913H158.824V17.0347H156.283C156.106 17.0347 155.958 16.9756 155.84 16.8575C155.721 16.7394 155.662 16.5918 155.662 16.4146V14.3184C155.662 14.1412 155.721 13.9936 155.84 13.8755C155.958 13.7574 156.106 13.6983 156.283 13.6983H160.862C161.217 13.6983 161.512 13.8263 161.749 14.0822C162.005 14.3184 162.133 14.6136 162.133 14.9679V16.0308L163.728 14.7612C164.319 14.2888 164.831 13.9641 165.264 13.7869C165.698 13.5901 166.21 13.4917 166.801 13.4917H167.716C167.894 13.4917 168.041 13.5507 168.16 13.6688C168.278 13.7869 168.337 13.9345 168.337 14.1117V16.3851C168.337 16.5623 168.278 16.7099 168.16 16.828C168.041 16.9461 167.894 17.0051 167.716 17.0051H166.948C166.436 17.0051 165.993 17.0937 165.619 17.2709C165.245 17.448 164.673 17.8417 163.905 18.4519L162.28 19.751V27.1913H165.205C165.382 27.1913 165.53 27.2503 165.648 27.3684C165.767 27.4865 165.826 27.6341 165.826 27.8113V29.9961C165.826 30.1733 165.767 30.3209 165.648 30.439C165.53 30.5571 165.382 30.6162 165.205 30.6162H156.578Z" />
              <path d="M176.675 30.6162C175.395 30.6162 174.213 30.3012 173.13 29.6714C172.066 29.0415 171.22 28.1853 170.589 27.1027C169.959 26.0201 169.644 24.8391 169.644 23.5597V20.371C169.644 19.0916 169.959 17.9106 170.589 16.828C171.22 15.7454 172.066 14.8892 173.13 14.2593C174.213 13.6294 175.395 13.3145 176.675 13.3145C177.956 13.3145 179.128 13.6294 180.191 14.2593C181.274 14.8892 182.131 15.7454 182.762 16.828C183.392 17.9106 183.707 19.0916 183.707 20.371V22.3492C183.707 22.7035 183.579 23.0086 183.323 23.2644C183.087 23.5006 182.791 23.6187 182.437 23.6187H173.189V23.7664C173.189 24.7309 173.524 25.5576 174.194 26.2465C174.883 26.9157 175.71 27.2503 176.675 27.2503H181.373C181.55 27.2503 181.698 27.3094 181.816 27.4275C181.934 27.5456 181.993 27.6932 181.993 27.8703V29.9961C181.993 30.1733 181.934 30.3209 181.816 30.439C181.698 30.5571 181.55 30.6162 181.373 30.6162H176.675ZM180.162 20.43V20.1643C180.162 19.1998 179.817 18.383 179.128 17.7137C178.458 17.0248 177.641 16.6804 176.675 16.6804C175.71 16.6804 174.883 17.0248 174.194 17.7137C173.524 18.383 173.189 19.1998 173.189 20.1643V20.43H180.162Z" />
              <path d="M190.833 31C189.178 31 187.829 30.5374 186.785 29.6123C185.761 28.6675 185.249 27.4472 185.249 25.9512C185.249 24.5931 185.722 23.4711 186.667 22.5854C187.613 21.6799 188.942 21.0894 190.656 20.8139C191.089 20.7745 191.503 20.7154 191.897 20.6367C193.275 20.4792 194.112 20.3611 194.408 20.2824C195.137 20.1643 195.501 19.751 195.501 19.0424C195.501 18.3141 195.196 17.7334 194.585 17.3004C193.994 16.8477 193.246 16.6213 192.34 16.6213C190.744 16.6213 189.582 17.202 188.853 18.3633C188.696 18.6192 188.509 18.7471 188.292 18.7471C188.135 18.7471 188.007 18.7077 187.908 18.629L186.254 17.5071C186.076 17.389 185.988 17.2217 185.988 17.0051C185.988 16.9461 186.007 16.8575 186.047 16.7394C186.618 15.6568 187.465 14.8203 188.588 14.2298C189.71 13.6196 190.981 13.3145 192.399 13.3145C193.699 13.3145 194.841 13.5605 195.826 14.0526C196.811 14.5447 197.569 15.2435 198.101 16.1489C198.652 17.0543 198.928 18.0976 198.928 19.2786V29.9961C198.928 30.1733 198.869 30.3209 198.751 30.439C198.633 30.5571 198.485 30.6162 198.308 30.6162H196.299C196.121 30.6162 195.974 30.567 195.856 30.4686C195.737 30.3505 195.678 30.193 195.678 29.9961V28.8447C194.319 30.2816 192.704 31 190.833 31ZM191.099 27.8408C191.867 27.8408 192.596 27.644 193.285 27.2503C193.975 26.8567 194.526 26.3449 194.94 25.715C195.373 25.0655 195.59 24.3864 195.59 23.6778V23.0873L193.374 23.4121C192.172 23.5499 191.394 23.6581 191.04 23.7368C189.425 24.0321 188.617 24.7309 188.617 25.8331C188.617 26.4433 188.844 26.9354 189.297 27.3094C189.75 27.6637 190.35 27.8408 191.099 27.8408Z" />
              <path d="M208.634 30.6162C207.098 30.6162 205.847 30.1438 204.882 29.199C203.937 28.2542 203.464 27.0141 203.464 25.4788V17.0051H201.425C201.248 17.0051 201.1 16.9461 200.982 16.828C200.864 16.7099 200.805 16.5623 200.805 16.3851V14.3184C200.805 14.1412 200.864 13.9936 200.982 13.8755C201.1 13.7574 201.248 13.6983 201.425 13.6983H203.464V10.5096C203.464 10.3325 203.523 10.1849 203.641 10.0668C203.759 9.94865 203.907 9.8896 204.084 9.8896H206.389C206.566 9.8896 206.714 9.94865 206.832 10.0668C206.95 10.1849 207.009 10.3325 207.009 10.5096V13.6983H212.002C212.18 13.6983 212.327 13.7574 212.445 13.8755C212.564 13.9936 212.623 14.1412 212.623 14.3184V16.4146C212.623 16.5918 212.564 16.7394 212.445 16.8575C212.327 16.9756 212.18 17.0347 212.002 17.0347H207.009V25.3312C207.009 25.9217 207.177 26.3941 207.511 26.7484C207.866 27.1027 208.329 27.2798 208.9 27.2798L212.002 27.3094C212.18 27.3094 212.327 27.3684 212.445 27.4865C212.564 27.6046 212.623 27.7522 212.623 27.9294V29.9961C212.623 30.1733 212.564 30.3209 212.445 30.439C212.327 30.5571 212.18 30.6162 212.002 30.6162H208.634Z" />
            </svg>
          </a>
        </h1>

        <div className="flex items-center justify-between">
          <menu className="flex items-center gap-6 font-bold">
            <li>
              <button popoverTarget={helpId}>Help</button>
            </li>
            <li>
              <a href="https://github.com/haggen/localthreat/issues/new/choose">
                Feedback
              </a>
            </li>
          </menu>

          <menu className="flex items-center gap-6 font-bold">
            <li>
              <button onClick={onShare} disabled>
                Share
              </button>
            </li>
            <li>
              <button disabled>New Report</button>
            </li>
            <li>
              <button popoverTarget={historyId}>History</button>
            </li>
          </menu>
        </div>
      </header>

      <main className="self-center">
        <article className="flex flex-col gap-3 p-6 items-center text-center">
          <h1 className="text-4xl opacity-50">
            Paste the transcript or members from chat…
          </h1>
          <p className="max-w-xl">
            Right-click on your chat transcript and select Copy All, or
            left-click on members and press CTRL-A followed by CTRL-C. Then come
            here and press CTRL-V to get a report of all characters affiliations
            and PvP stats.
          </p>
        </article>

        <Panel id={helpId} title="Help" side="left">
          <div className="flex flex-col gap-12 p-6 overflow-y-auto">
            <article className="flex flex-col gap-3">
              <h1 className="text-xl font-bold">What is localthreat?</h1>
              <p>
                It's a website that helps players of EVE Online quickly identify
                friend from foe and assess the level of threat their enemies may
                present.
              </p>
            </article>
            <article className="flex flex-col gap-3">
              <h1 className="text-xl font-bold">How does it work?</h1>
              <p>
                With the window in focus, it listens for paste events from the
                user. You'll need to copy a chat transcript or a channel member
                list from in-game and press CTRL+V on this page. Once input is
                detected, it parses the content for character names and queries
                information from the game servers and other third-party APIs to
                offer a complete report of affiliations and PvP statistics for
                those players.
              </p>
            </article>
            <article className="flex flex-col gap-3">
              <h1 className="text-xl font-bold">What else can it do?</h1>
              <ul className="list-disc pl-6">
                <li>
                  A report will have a unique URL that can be shared with your
                  friends.
                </li>
                <li>
                  The table can be sorted alphabetically or by any of the
                  displayed stats.
                </li>
                <li>
                  Pasting into an existing report will add non-duplicate names
                  to it.
                </li>
                <li>
                  A history of visited reports will be stored locally in your
                  browser and can be accessed using the History panel.
                </li>
                <li>
                  <del>Overheat belief!</del>
                </li>
              </ul>
            </article>
            <article className="flex flex-col gap-3">
              <h1 className="text-xl font-bold">How much does it cost?</h1>
              <p>
                Nothing to you. localthreat is completely free to use, displays
                no ads, and has its{" "}
                <a
                  href="https://github.com/haggen/localthreat"
                  className="underline"
                >
                  source code released on GitHub
                </a>
                . Although the service has some costs associated with hosting
                and maintenance, I've been happily covering it for the past{" "}
                {new Date().getFullYear() - 2017} years.
              </p>
            </article>
            <article className="flex flex-col gap-3">
              <h1 className="text-xl font-bold">I have other questions.</h1>
              <p>
                If you'd like, we can chat about what's on your mind. You may{" "}
                <a
                  href="https://github.com/haggen/localthreat/issues/new"
                  className="underline"
                >
                  open an issue on GitHub
                </a>{" "}
                or send an EVE-mail to <strong>Jason Chorant</strong>, and I'll
                get back to you—eventually.
              </p>
            </article>
          </div>
        </Panel>

        <Panel id={historyId} title="History" side="right">
          <div className="p-6">
            <p>Hello, world.</p>
          </div>
        </Panel>
      </main>

      <footer className="flex flex-col gap-3 p-6 text-center not-hover:opacity-50 transition-opacity">
        <p>
          © 2017 Arthur Corenzan. Source on{" "}
          <a className="underline" href="http://github.com/haggen/localthreat">
            GitHub
          </a>
          . Data provided by{" "}
          <a className="underline" href="https://esi.evetech.net/latest/">
            ESI
          </a>{" "}
          and{" "}
          <a className="underline" href="https://zkillboard.com/">
            zKillboard
          </a>
          . Tips go to{" "}
          <a
            className="underline"
            href="https://zkillboard.com/character/95036967/"
          >
            Jason Chorant
          </a>
          .
        </p>
        <p className="text-xs">
          EVE Online and the EVE logo are the registered trademarks of CCP hf.
          All rights are reserved worldwide. All other trademarks are the
          property of their respective owners. EVE Online, the EVE logo, EVE and
          all associated logos and designs are the intellectual property of CCP
          hf. All artwork, screenshots, characters, vehicles, storylines, world
          facts or other recognizable features of the intellectual property
          relating to these trademarks are likewise the intellectual property of
          CCP hf.
        </p>
      </footer>
    </div>
  );
}
